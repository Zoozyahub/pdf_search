
# ReadMe
### Описание

Тестовое задание: поиск по тексту PDF-документа (Конституция РФ).

### Стэк
-   **Spacy** – лемматизация
-   **Rank-BM25** – алгоритм ранжирования документов
-   **PyMuPDF (fitz)** – обработка PDF

### Описание реализации
-   Чтение текста из PDF
-   Очистка от мусора (символы `<*>`, переносы строк)
-   Создание словаря `{Статья: [пункты]}`
-   Удаление пунктуации перед лемматизацией
-   Лемматизация с использованием Spacy
-   Индексация данных в BM25
-   Поиск релевантных статей и восстановление исходного текста

### Обоснование выбранных технологий и подхода 
- Выбор BM25
Рассматривались такие варианты как TF-IDF и SentenceTransformers.
BM25 был выбран вместо TF-IDF, так как он является улучшенной версией последнего и обеспечивает более точный поиск, особенно в длинных документах.
Использование SentenceTransformers показалось избыточным. В случае если бы рассматривали что-то другое, например художественное произведение SentenceTransformers был бы приоритетнее так-как позволяет производить семантический поиск. В данном случае ключевые слова играют решающую роль, поэтому BM25 обеспечивает точность поиска на достаточном уровне.
- Spacy 
был выбран благодаря удобному встроенному функционалу для токенизации и лемматизации, что ускоряет предобработку текста. 

### пример работы:

Инициализация...
Для завершения введите стоп:
Введите запрос:
`Права человека`

Статья 17:
1. В Российской Федерации признаются и гарантируются права и свободы человека и гражданина согласно общепризнанным принципам и нормам международного права и в соответствии с настоящей Конституцией.
2. Основные права и свободы человека неотчуждаемы и принадлежат каждому от рождения.
3. Осуществление прав и свобод человека и гражданина не должно нарушать права и свободы других лиц.

Статья 2:
Человек, его права и свободы являются высшей ценностью. Признание, соблюдение и защита прав и свобод человека и гражданина - обязанность государства.

Статья 55:
1. Перечисление в Конституции Российской Федерации основных прав и свобод не должно толковаться как отрицание или умаление других общепризнанных прав и свобод человека и гражданина. прав и свобод человека и гражданина.
2. В Российской Федерации не должны издаваться законы, отменяющие или умаляющие права и свободы человека и гражданина.                          в конституционного строя, нравственности, здоровья,
3. Права и свободы человека и гражданина могут быть ограничены федеральным законом только в той мере, в какой это необходимо в целях защиты основ конституционного строя, нравственности, здоровья, прав и законных интересов других лиц, обеспечения обороны страны и безопасности государства.

Введите запрос:
`Статья 40`

Статья 40:
1. Каждый имеет право на жилище. Никто не может быть произвольно лишен жилища.
2. Органы государственной власти и органы местного самоуправления поощряют жилищное строительство, создают условия для осуществления права на жилище.
3. Малоимущим,  иным  указанным  в законе  гражданам,  нуждающимся  в  жилище,  оно предоставляется бесплатно или за доступную плату из государственных, муниципальных и других жилищных фондов в соответствии с установленными законом нормами.
Введите запрос:
Введите запрос:
стоп

## Часть 2 (Поиск по изображениям)

### Стэк
-   **CLIP (OpenAI)** – векторизация изображений и текста
-   **scikit-learn** – поиск по косинусному сходству 
-   **matplotlib** – визуализация изображений
### Описание
1) Прогоняем все картинки (CIFAR10 + 25 скачанных по тематике) через CLIP
2) Прогоняем все статьи через CLIP
3) Так-как в моем случае, мы при любом раскладе получим какую-то статью, было принято решение один раз записать csv с эмбеддингами статей и путями к найденным изображениям. 
4) Для поиска по изображению пользователя: Кодируем картинку также через CLIP, выводим топ 3 найденных текстовых фрагмента c заранее сопоставленными картинками по косинусной близости.    

### Выбор технологии
Учитывая что поиск по изображениям в конституции, является достаточно специфической задачей, и сбор подходящего датасета, занял бы много времени такие варинты как ResNet и простые автоэнкодеры сразу отпали. В итоге была выбрана сеть **CLIP** чтобы искать соответствия с текстом 

### Примеры 
Примеры работы в конце ноутбука experiments.ipynb


